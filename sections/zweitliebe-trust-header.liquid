{% comment %} ZWEITLIEBE STUDIBUCH TRUST HEADER {% endcomment %}
{%- liquid
  assign show_trust_messages = section.settings.show_trust_messages | default: true
  assign show_search_enhancement = section.settings.show_search_enhancement | default: true
  assign show_category_nav = section.settings.show_category_nav | default: true
-%}

<style>
/* === ZWEITLIEBE STUDIBUCH HEADER STYLES === */
.zweitliebe-header {
  background: white;
  border-bottom: 1px solid #E5E7EB;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.zweitliebe-trust-strip {
  background: linear-gradient(135deg, #2D5A27 0%, #22C55E 100%);
  color: white;
  padding: 8px 0;
  font-size: 12px;
  font-weight: 500;
  text-align: center;
}

.zweitliebe-trust-messages {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 32px;
  flex-wrap: wrap;
}

.zweitliebe-trust-message {
  display: flex;
  align-items: center;
  gap: 6px;
}

.zweitliebe-main-header {
  padding: 16px 0;
}

.zweitliebe-header-content {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 20px;
  display: grid;
  grid-template-columns: 200px 1fr auto;
  align-items: center;
  gap: 32px;
}

.zweitliebe-logo {
  font-size: 24px;
  font-weight: 800;
  color: #2D5A27;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 8px;
}

.zweitliebe-search-container {
  max-width: 600px;
  position: relative;
}

.zweitliebe-search-input {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #E5E7EB;
  border-radius: 8px;
  font-size: 16px;
  transition: all 0.2s;
}

.zweitliebe-search-input:focus {
  outline: none;
  border-color: #2D5A27;
  box-shadow: 0 0 0 3px rgba(45, 90, 39, 0.1);
}

.zweitliebe-search-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid #E5E7EB;
  border-radius: 8px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  z-index: 1000;
  margin-top: 4px;
}

.zweitliebe-search-suggestion {
  padding: 12px 16px;
  cursor: pointer;
  border-bottom: 1px solid #F3F4F6;
  transition: background-color 0.2s;
}

.zweitliebe-search-suggestion:hover {
  background-color: #F9FAFB;
}

.zweitliebe-header-actions {
  display: flex;
  align-items: center;
  gap: 16px;
}

.zweitliebe-cart-button {
  background: #2D5A27;
  color: white;
  padding: 12px 16px;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
}

.zweitliebe-cart-button:hover {
  background: #1F3A1B;
  transform: translateY(-1px);
}

.zweitliebe-category-nav {
  background: #F9FAFB;
  border-top: 1px solid #E5E7EB;
  padding: 12px 0;
}

.zweitliebe-categories {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  justify-content: center;
  gap: 32px;
  flex-wrap: wrap;
}

.zweitliebe-category-link {
  color: #374151;
  text-decoration: none;
  font-weight: 500;
  padding: 8px 12px;
  border-radius: 6px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 6px;
}

.zweitliebe-category-link:hover {
  background: white;
  color: #2D5A27;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .zweitliebe-header-content {
    grid-template-columns: 1fr;
    gap: 16px;
    text-align: center;
  }
  
  .zweitliebe-trust-messages {
    gap: 16px;
  }
  
  .zweitliebe-categories {
    gap: 16px;
  }
  
  .zweitliebe-category-link {
    font-size: 14px;
    padding: 6px 10px;
  }
}

/* Entferne ALLE Tech-Hintergründe */
.zweitliebe-header *,
.zweitliebe-header::before,
.zweitliebe-header::after {
  background-image: none !important;
  background: none !important;
}
</style>

<header class="zweitliebe-header" role="banner">
  {% if show_trust_messages %}
  <div class="zweitliebe-trust-strip">
    <div class="zweitliebe-trust-messages">
      <div class="zweitliebe-trust-message">
        <span>📚</span>
        <span>180.000+ Fachbücher</span>
      </div>
      <div class="zweitliebe-trust-message">
        <span>🚚</span>
        <span>Kostenloser Versand ab 10€</span>
      </div>
      <div class="zweitliebe-trust-message">
        <span>🛡️</span>
        <span>36 Monate Garantie</span>
      </div>
      <div class="zweitliebe-trust-message">
        <span>⭐</span>
        <span>4.8/5 von Studierenden</span>
      </div>
    </div>
  </div>
  {% endif %}

  <div class="zweitliebe-main-header">
    <div class="zweitliebe-header-content">
      <!-- Logo -->
      <a href="{{ routes.root_url }}" class="zweitliebe-logo">
        <span>📚</span>
        <span>{{ shop.name | default: 'Zweitliebe' }}</span>
      </a>

      <!-- Enhanced Search -->
      {% if show_search_enhancement %}
      <div class="zweitliebe-search-container">
        <form action="{{ routes.search_url }}" method="get" role="search">
          <input 
            type="search" 
            name="q" 
            placeholder="ISBN, Autor, Titel oder Fachbereich eingeben..." 
            class="zweitliebe-search-input"
            autocomplete="off"
            data-zweitliebe-search
          >
          <div class="zweitliebe-search-suggestions" style="display: none;" data-zweitliebe-suggestions>
            <div class="zweitliebe-search-suggestion" data-category="medizin">🩺 Medizin & Gesundheit</div>
            <div class="zweitliebe-search-suggestion" data-category="bwl">💼 BWL & Wirtschaft</div>
            <div class="zweitliebe-search-suggestion" data-category="jura">⚖️ Jura & Recht</div>
            <div class="zweitliebe-search-suggestion" data-category="informatik">💻 Informatik & IT</div>
            <div class="zweitliebe-search-suggestion" data-category="psychologie">🧠 Psychologie</div>
            <div class="zweitliebe-search-suggestion" data-category="mathematik">📐 Mathematik & Statistik</div>
          </div>
        </form>
      </div>
      {% endif %}

      <!-- Header Actions -->
      <div class="zweitliebe-header-actions">
        <a href="{{ routes.account_url }}" class="zweitliebe-account-link" title="Mein Konto">
          👤 Konto
        </a>
        <button type="button" class="zweitliebe-cart-button" data-cart-drawer-toggle>
          🛒 Warenkorb
          <span class="cart-count">{{ cart.item_count }}</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Category Navigation -->
  {% if show_category_nav %}
  <nav class="zweitliebe-category-nav" role="navigation">
    <div class="zweitliebe-categories">
      <a href="/collections/medizin" class="zweitliebe-category-link">
        <span>🩺</span>
        <span>Medizin & Psychologie</span>
      </a>
      <a href="/collections/bwl" class="zweitliebe-category-link">
        <span>💼</span>
        <span>Wirtschaft & Recht</span>
      </a>
      <a href="/collections/informatik" class="zweitliebe-category-link">
        <span>💻</span>
        <span>Mathematik & Technik</span>
      </a>
      <a href="/collections/naturwissenschaften" class="zweitliebe-category-link">
        <span>🧬</span>
        <span>Naturwissenschaften</span>
      </a>
      <a href="/collections/geisteswissenschaften" class="zweitliebe-category-link">
        <span>📖</span>
        <span>Geisteswissenschaften</span>
      </a>
      <a href="/collections/all" class="zweitliebe-category-link">
        <span>🎓</span>
        <span>Alle Fachbücher</span>
      </a>
    </div>
  </nav>
  {% endif %}
</header>

<script>
// Enhanced Search Functionality
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.querySelector('[data-zweitliebe-search]');
  const suggestions = document.querySelector('[data-zweitliebe-suggestions]');
  
  if (searchInput && suggestions) {
    let searchTimeout;
    
    // Academic search terms for auto-complete
    const academicTerms = [
      'Anatomie', 'Physiologie', 'Pharmakologie', 'Innere Medizin',
      'Marketing', 'Controlling', 'Buchhaltung', 'Unternehmensführung',
      'BGB', 'Strafrecht', 'Verfassungsrecht', 'Zivilrecht',
      'Java', 'Python', 'Algorithmen', 'Datenbanken', 'Software Engineering',
      'Sozialpsychologie', 'Entwicklungspsychologie', 'Klinische Psychologie',
      'Analysis', 'Lineare Algebra', 'Statistik', 'Wahrscheinlichkeitsrechnung'
    ];
    
    searchInput.addEventListener('input', function() {
      clearTimeout(searchTimeout);
      const query = this.value.toLowerCase();
      
      if (query.length > 1) {
        searchTimeout = setTimeout(() => {
          const matches = academicTerms.filter(term => 
            term.toLowerCase().includes(query)
          );
          
          if (matches.length > 0) {
            suggestions.innerHTML = matches.slice(0, 5).map(term => 
              `<div class="zweitliebe-search-suggestion" data-term="${term}">${term}</div>`
            ).join('');
            suggestions.style.display = 'block';
            
            // Add click handlers
            suggestions.querySelectorAll('.zweitliebe-search-suggestion').forEach(item => {
              item.addEventListener('click', function() {
                searchInput.value = this.dataset.term;
                suggestions.style.display = 'none';
                searchInput.form.submit();
              });
            });
          } else {
            suggestions.style.display = 'none';
          }
        }, 200);
      } else {
        suggestions.style.display = 'none';
      }
    });
    
    // Category suggestions
    suggestions.querySelectorAll('[data-category]').forEach(item => {
      item.addEventListener('click', function() {
        window.location.href = `/collections/${this.dataset.category}`;
      });
    });
    
    // Hide suggestions when clicking outside
    document.addEventListener('click', function(e) {
      if (!searchInput.contains(e.target) && !suggestions.contains(e.target)) {
        suggestions.style.display = 'none';
      }
    });
  }
  
  // AGGRESSIVE TECH IMAGE ELIMINATION
  function eliminateTechImages() {
    // Remove all background images from header elements
    const headerElements = document.querySelectorAll('.zweitliebe-header *');
    headerElements.forEach(el => {
      el.style.backgroundImage = 'none';
      el.style.background = 'none';
    });
    
    // Hide tech-related images globally
    const allImages = document.querySelectorAll('img');
    allImages.forEach(img => {
      const src = img.src?.toLowerCase() || '';
      const alt = img.alt?.toLowerCase() || '';
      
      if (src.includes('camera') || src.includes('laptop') || src.includes('watch') || 
          src.includes('tech') || src.includes('computer') || src.includes('phone') ||
          alt.includes('camera') || alt.includes('laptop') || alt.includes('tech')) {
        img.style.display = 'none';
      }
    });
    
    // Replace any tech backgrounds with book-friendly gradients
    const allElements = document.querySelectorAll('*');
    allElements.forEach(el => {
      const style = getComputedStyle(el);
      if (style.backgroundImage && style.backgroundImage !== 'none') {
        const bgImage = style.backgroundImage.toLowerCase();
        if (bgImage.includes('camera') || bgImage.includes('tech') || bgImage.includes('laptop')) {
          el.style.backgroundImage = 'linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%)';
        }
      }
    });
  }
  
  // Run elimination immediately and repeatedly
  eliminateTechImages();
  setInterval(eliminateTechImages, 1000);
});
</script>

{% schema %}
{
  "name": "Zweitliebe Trust Header",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_trust_messages",
      "label": "Trust-Nachrichten anzeigen",
      "default": true
    },
    {
      "type": "checkbox", 
      "id": "show_search_enhancement",
      "label": "Erweiterte Suche anzeigen",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_category_nav",
      "label": "Kategorie-Navigation anzeigen", 
      "default": true
    }
  ]
}
{% endschema %} 